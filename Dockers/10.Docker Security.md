# âœ… Topic 10: Docker Security Best Practices

"Containers are secure by default" â€” this is partially true. You must follow good practices to ensure isolation, hardening, and vulnerability mitigation.

## ğŸ›¡ï¸ 10.1 Key Docker Security Risks

| Risk                 | Description                             |
|----------------------|---------------------------------------|
| Image Vulnerabilities | Outdated packages, malicious code     |
| Insecure Configuration| Exposing privileged access, root users|
| Excessive Permissions | Running as root inside containers      |
| Network Exposure      | Open ports, weak firewall rules        |
| Secret Leakage       | Hardcoded creds in images or environment|

## ğŸ”’ 10.2 Security Best Practices (Organized)

### ğŸ“¦ A. Docker Image Security

- âœ… Use minimal base images  
```dockerfile
FROM alpine
FROM mcr.microsoft.com/dotnet/aspnet:8.0
```
-âœ… Use official and verified images
   - Avoid images from unknown sources.

-âœ… Scan images for vulnerabilities
```bash
docker scan <image-name>
```
Or tools like:

-Trivy

-Snyk

-âœ… Multi-stage builds
  - Donâ€™t include build tools in final image.

-âœ… Avoid hardcoding secrets

âŒ BAD example:
```bash
ENV DB_PASSWORD=admin123
```
- âœ… BETTER: Use secrets manager or bind-mounted secrets.

---
  # ğŸ§ B. User Permissions
  
 - âœ… Donâ€™t run containers as root (inside)
```bash
RUN adduser -u 1001 appuser
USER appuser
```
- âœ… Drop capabilities unless needed:
```bash
docker run --cap-drop=ALL --cap-add=NET_BIND_SERVICE ...
```
- âœ… Use read-only filesystem:
```bash
docker run --read-only ...
```
- âœ… Use seccomp, AppArmor, SELinux profiles (Advanced).

### ğŸŒ C. Networking & Ports

- âœ… **Only expose necessary ports**  
```yaml
ports:
  - "8080:80"   # Expose only required ports
```
- âœ… Use custom bridge networks for container isolation
```bash
docker network create internal-net
```
- âœ… Use firewalls & security groups (in cloud)

# ğŸ“ D. Volumes and Secrets

- âœ… Use volumes with least privilege

- âœ… Avoid mounting host root

  âŒ Avoid:

  ```bash
  -v /:/host
  ```
- âœ… Use Docker secrets (Swarm only) or external tools:

    - AWS Secrets Manager
    - HashiCorp Vault
    - Azure Key Vault

- âœ… Avoid storing .env files in Git

# âš™ï¸ E. Runtime Security

- âœ… Enable resource limits
```bash
docker run --memory="512m" --cpus="1.0"
```

- âœ… Limit restart policy
```bash
restart: on-failure
```
- âœ… Donâ€™t use --privileged flag unless required

- âœ… Audit logs with:
```bash
docker events
```

- âœ… Use runtime security tools:

- Falco (Cloud Native runtime security)

- Sysdig

# F. Build-Time and DevOps Security 

- âœ… Use .dockerignore to avoid leaking sensitive files such as:
```bash
.git
.env
*.pem
```
- âœ… Sign Docker images using Docker Content Trust:
```bash
export DOCKER_CONTENT_TRUST=1
```
- âœ… Keep your Docker Engine updated

- ### ğŸ“Œ Security Checklist Summary

| Best Practice                     | âœ… |
|----------------------------------|----|
| Use minimal base images          | âœ… |
| Donâ€™t run as root                | âœ… |
| Avoid hardcoding secrets         | âœ… |
| Scan images for CVEs             | âœ… |
| Use .dockerignore                | âœ… |
| Limit open ports                 | âœ… |
| Set resource limits              | âœ… |
| Isolate with custom networks     | âœ… |
| Use trusted image sources        | âœ… |
| Avoid --privileged containers    | âœ… |



























